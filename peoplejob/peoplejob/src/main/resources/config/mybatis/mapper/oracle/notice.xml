<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.notice">
<insert id="insertNotice" parameterType="noticeVo">
		<selectKey resultType="int" keyProperty="notify_code" order="BEFORE">
			select notice_seq.nextval from dual
		</selectKey>
		insert into notice(notify_code, notifytitle, notifycontent, admin_code) 
		values(#{notify_code}, #{notifytitle}, #{notifycontent}, #{admin_code})
	</insert>
	
	<select id="selectSearch" parameterType="searchVo" resultType="boardVo">
		select *
		from
		(
		    select A.*, rownum as RNUM 
		    from
		    (
		        select notify_code, notifytitle, notifycontent, readcount,notifydate,
					(sysdate-notifydate)*24 as new_Img_Term
				from notice		
				<if test="searchKeyword != null and searchKeyword != ''">
					where ${searchCondition} like '%' || #{searchKeyword} || '%'
				</if>		
				order by notify_code desc
		    ) A
		)
		<![CDATA[ where RNUM>#{firstRecordIndex}  
		and RNUM<=#{firstRecordIndex} + #{recordCountPerPage}]]>
	</select>
	 
	 <select id="selectTotalCount" parameterType="searchVo" resultType="int">
	 select count(*) from notice
	 <if test="searchKeyword != null and searchKeyword !=''">
	 	where ${searchCondition} like '%' || #{searchKeyword} || '%'
	 </if>
	 </select>
</mapper>









